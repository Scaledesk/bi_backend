{% extends "base.html" %}
{% include "kitchen/reload-flex.html" %}

{% block custom_css %}

{% endblock %}

{% block content %}
<div class="tzcategory-shop-wrap">
  <div class="container">

    <div class="row">
      <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <h3 class="tz-title-bold-3">{{ kitchen.name }}</h3>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12">
          <div id="tz-shop-content" class="row">

####################################################################################
<!-- <div calss="reload_flex" id="reload_flex"> -->


            <div class="col-lg-11 col-md-11 col-sm-12 col-xs-12">
              <div id="slider" class="flexslider">
                <ul class="slides">
                  {% for obj in k_images %}
                  <li>
                    <img src="{{obj.image.url}}" alt="Roses Deco Accent Chair" width="685" height="680"/>
                  </li>
                  {% endfor %}
                </ul>
              </div>
              <div id="carousel">
                <ul class="slides">
                  {% for obj in k_images %}
                  <li>
                    <img src="{{obj.image.url}}" alt="Roses Deco Accent Chair" width="80" height="60"/>
                  </li>
                  {% endfor %}
                </ul>
              </div>
            </div>







          </div>




          <div class="col-lg-1 col-md-1">
          </div>
        <!-- </div>         -->
        <div class="tzshop-summary">

          <h6 class="tz-title-details">KITCHEN DETAILS</h6>
          <ul class="tzshop-status">
            <li>
              <span>Unit:</span> {{ kitchen.name }}
            </li>

            <li>
              <span>Type: </span> {{ kitchen.theme.name }}
            </li>

            <li>
              <span>Size (in mm):</span> {{ kitchen.l }} x {{ kitchen.b }} x {{ kitchen.h }}
            </li>
            <li>
              <span>Includes: </span> Shelf
            </li>

          </ul>
          <p>{{ kitchen.desc }}</p>
          <a class="tzheart" href="#">
            <span class="tz-shop-detail-meta">
              <i class="fa fa-heart"></i>
            </a>
          </span>
        </div>


      </div>
      <div id="tz-wp-content" class="col-lg-4 col-md-4 col-sm-4 col-xs-12 tzshop-aside">

        <h3 class="module-title title-widget"><span>Available option</span></h3>
        <div class="clearfix" id="tz-shop-content"></div>

        <div class="product-options" id="product-options-wrapper">


          <dl class="last">
            <div class="row">
              <div class="col-xs-5 pull-left">

                <label>Size (in mm)<span style="float:right; text-decoration:none"></span>
                </label>
              </div>
              <div class="col-xs-5 pull-right">
                <div class="input-box" style="display: block;">

                  {{ kitchen.l }} x {{ kitchen.b }} x {{ kitchen.h }}

                </div>
              </div>
            </div>

            <br>


            <dt><label class="required"><em>*</em>Select Cabinet Material<span style="float:right; text-decoration:none"></span>
            </label>
          </dt>
          <dd>
            <div class="input-box" style="display: block;">
              <select name="super_attribute[149]" id="select_material" class="required-entry super-attribute-select">
                <option id="default_material">Choose an Option...</option>

                {% for obj in k_material %}
                <option>{{obj.name}}</option>
                {% endfor %}

              </select>
            </div>
          </dd>


          <dt><label class="required"><em>*</em>Select Shutter Finish<span style="float:right; text-decoration:none"><a href="http://www.modspace.in/step-3#fin" class="sc_hover tr_delay">Need help?</a></span>
          </label>
        </dt>
        <dd>
          <div class="input-box" style="display: block;">
            <select name="super_attribute[146]" id="select_finish" class="required-entry super-attribute-select">
              <option id="default_finish">Choose an Option...</option>

              {% for obj in k_finishing %}
              <option>{{ obj.name }}</option>
              {% endfor %}

            </select>
          </div>

        </dd>
        <dt><label class="required"><em>*</em>Select Color<span class="select-label" id="select_label_color">Brown Grey and Linen</span>

        </label>
      </dt>
      <dd class="last">

        <div class="color-swatch-wrapper">
          <ul id="color-swatch-attribute-92" class="is-disabled-attribute">

            <li class="p-0 border-0">
              <span class="swatch-title" id="color_0"  onclick="colorActive(0)" info="Custom" style="width:25px; height:25px; line-height:25px; position:relative; border: 2px solid green;">&nbsp;
                <img class="image-base" id="c_0" name="all" src="/static/all.png" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;">
              </span>
            </li>

            {% for obj in k_images %}

            <li class="p-0 border-0">
              <span class="swatch-title" id="color_{{ forloop.counter }}" onclick="colorActive( {{ forloop.counter }} )" info="Custom" style="width:25px; height:25px; line-height:25px; position:relative; border: 2px solid transparent;">&nbsp;
                <img class="image-base" id="c_{{ forloop.counter }}" name="{{ obj.k_color.name }}" src="{{ obj.k_color.image.url }}" style="position: absolute; top: 0;left: 0;width: 100%;height: 100%;">
              </span>
            </li>

            {% endfor %}



          </ul>
          <input type="hidden" id="hidden-attribute-92" name="super_attribute[92]" class="required-entry hidden-super-attribute-select">
        </div>
        <br class="clearfloat">
      </dd>
    </dl>
    <h3 class="module-title" id="base_price">{{ min_price }} to {{max_price}}</h3>
    <div class="row text-center">
      <div class="col-xs-6">
        <a href="#" class="p-share">
          <span  data-toggle="modal" data-target="#myModal">GET CUSTOM QUOTE</span>
        </a>
      </div>
      <div class="col-xs-6">
        <a href="#" class="p-share" >
          <span data-toggle="modal" data-target="#myModal1" >ADD APPLIANCES</span>
        </a>
      </div>

    </div>
    <p class="required">* Required Fields</p>
  </div>
</div>
</div>
<div class="row">
  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <div class="tabs-style">
      <ul class="nav nav-tabs" role="tablist" id="detailTab">
        <li class="active"><a href="#infomation" role="tab" data-toggle="tab">What's Included</a></li>


      </ul>
      <div class="tab-content">
        <div class="tab-pane active" id="infomation">
          <div class="container">
            <form method="post" action="#">
              <table class="shop_table">
                <thead>
                  <tr>
                    <th class="product-image">Image</th>
                    <th class="name">Category</th>
                    <th class="porduct-quantity">Brand</th>
                    <th class="product-price">Sub-Category</th>
                    <th class="product-total">Is Included</th>
                  </tr>
                </thead>
                <tbody>

                  {% for obj in k_includes %}
                  {% for sub_obj in obj.ki_sub %}
                  <tr class="cart_table_item">
                    <!-- Product image-->
                    <td class="product-img">
                      <img alt="01" class="wp-post-image" src="{{obj.image.url}}">
                    </td>
                    <!-- Product brand -->
                    <td class="product-subtotal">
                      <span class="price">{{obj.category}}</span>
                    </td>
                    <!-- Quantity size -->
                    <td class="product-quantity">
                      <span>{{ obj.brand }}</span>
                    </td>
                    <!-- Quantity inputs -->
                    <td class="product-price">
                      <span class="price">{{sub_obj.sub_category}}</span>
                    </td>


                    <!-- Product Code -->
                    {% if sub_obj.is_included %}
                    <td class="product-name">
                      <input type="checkbox" name="vehicle" value="Bike" disabled checked>
                    </td>
                    {% else %}
                    <td class="product-name">
                      <input type="checkbox" name="vehicle" value="Bike" disabled>
                    </td>
                    {% endif %}

                    <!-- Remove from cart link -->
                    <!-- <td class="product-remove">
                    <a title="Remove this item" class="remove" href="#"><i class="fa fa-trash-o"></i></a>
                  </td>-->
                </tr>

                {% endfor %}
                {% endfor %}

              </tbody>
            </table>
          </form>





        </div><!--end class container-->
      </div>
      <!--   <div class="tab-pane" id="specifications">
      <div class="tzrelated">
      <div class="container">
      <div class="row">

      {% for obj in k_appliances %}

      <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
      <div class="tz-tzrelated">
      <div class="tz-tzrelated-img">
      <img alt="Nulla tortor nulla" src="{{ obj.image.url }}">

    </div>
    <h6><a href="#">{{ obj.desc }}</a></h6>
    <span>{{ obj.name }}</span>
  </div>
</div>

{% endfor %}


</div>&lt;!&ndash;end class row&ndash;&gt;
</div>&lt;!&ndash;end class container&ndash;&gt;
</div>
</div>-->
</div>
</div>
</div>
</div>
</div><!--end class container-->
</div><!--end class tzblog-wrap-->



<!--modal of add appliance-->

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Modal Header</h4>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-xs-pull-12">
            <div class="cta-form cta-light custom-quote-form">

              <form id="send_data_form" class="send_data_form" method="post" action="/kitchen/product-consultation/" enctype="multipart/form-data">
                <!-- <form id="cta-signup-form" class="cta-signup-form"> -->
                <h2 class="text-center">Dream Kitchen</h2>
                <hr class="hr-color hr-style">
                <div id="mc-error-cta"><i class="fa fa-exclamation-triangle"></i> Please enter a value</div>
                <div id="mc-success-cta"><i class="fa fa-envelope"></i> Awesome! We have sent you a confirmation email</div>
                {% csrf_token %}
                <div class="form-group"> <i class="fa fa-user"></i>
                  <input type="text" value="" name="name" class="form-control input-lg form-input-custom" id="name" placeholder="Name" required="">
                </div>
                <div class="form-group"> <i class="fa fa-phone-square" aria-hidden="true"></i>
                  <input type="contact_no" value="" name="contact_no" class="form-control input-lg form-input-custom" id="contact_no" placeholder="Contact No." required="">
                </div>
                <div class="form-group"> <i class="fa fa-envelope" aria-hidden="true"></i>
                  <input type="email" value="" name="user_email" class="form-control input-lg form-input-custom" id="email" placeholder="Email" required="">
                </div>
                <div class="form-group"> <i class="fa fa-map-marker" aria-hidden="true"></i>
                  <input type="text" value="" name="address" class="form-control input-lg form-input-custom" id="address" placeholder="Address" required="">
                </div>
                <input type="text" value="all" name="color" id="selected_color"  required="" hidden>
                <input type="text" value="None" name="material" id="selected_material"  required="" hidden>
                <input type="text" value="None" name="finish" id="selected_finish"  required="" hidden>
                <input type="text" value="{{kitchen.id}}" name="kitchen" id="selected_kitchen"  required="" hidden>
                <input type="text" value="None" name="selected_appliance" id="selected_appliance"  required="" hidden>
                <div class="form-btn">
                  <button type="submit" class="btn hollow-btn1">Get Free Consultation</button>
                  <br>
                </div>
              </form>

            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>



<!-- Modal1 -->
<div id="myModal1" class="modal fade" role="dialog">
  <div class="modal-dialog" style="width: 95%;">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Modal Header</h4>
      </div>
      <div class="modal-body">


        <div class="container">
          <form method="post" action="#">
            <table class="shop_table">
              <thead>
                <tr>
                  <th class="product-image">Image</th>
                  <th class="product-total">Name</th>
                  <th class="porduct-quantity">Description</th>
                  <th class="name text-center">Click to Include</th>
                </tr>
              </thead>
              <tbody>

                {% for obj in k_appliances %}
                <tr class="cart_table_item">
                  <!-- Product image-->
                  <td class="product-img">
                    <img alt="01" class="wp-post-image" src="{{obj.image.url}}">
                  </td>
                  <!-- Product brand -->
                  <td class="product-subtotal ">
                    <span class="price">{{obj.name}}</span>
                  </td>
                  <!-- Quantity size -->
                  <td class="product-quantity text-center">
                    <span>{{ obj.desc }}</span>
                  </td>
                  <!-- Product Code -->
                  <td class="product-name text-center ">
                    <form action="">
                      <input type="checkbox" name="tick" id="appliance_{{obj.id}}" appliance_name="{{obj.name}}" onclick="addAppliance(appliance_{{obj.id}})"><br>
                    </form>
                  </td>
                  <!-- Remove from cart link -->
                  <!-- <td class="product-remove">
                  <a title="Remove this item" class="remove" href="#"><i class="fa fa-trash-o"></i></a>
                </td>-->
              </tr>
              {% endfor %}

            </tbody>
          </table>
        </form>
      </div><!--end class container-->
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
    </div>
  </div>

</div>
</div>

{% endblock %}

{% block custom_script %}

<script>
var initial_style = "width:25px; height:25px; line-height:25px; position:relative; border: 2px solid transparent;";
var selected_style = "width:25px; height:25px; line-height:25px; position:relative; border: 2px solid green;";
var appliance_array = []
var color = ""
var default_material = document.getElementById('select_material').value;
var default_finish = document.getElementById('select_finish').value;

var selected = 0;
function colorActive(color_id){
  document.getElementById("color_"+selected).style = initial_style;
  selected = color_id;
  document.getElementById("color_"+color_id).style = selected_style;
  document.getElementById('selected_color').value = document.getElementById("c_"+color_id).getAttribute("name");


  // code to relod the flex images on selecting colors
  $.ajax({
    type: "POST",
    url: "/kitchen/reload-flex/",
    data: { kitchen_id:{{ kitchen.id }}, color:document.getElementById("c_"+color_id).getAttribute("name"), csrfmiddlewaretoken:getCookie('csrftoken') },
    success: function( returnedData) {
      // alert(returnedData)
      $( '#reload_flex').html( returnedData );
      $("#reload_flex").page();
    }
  });
}

function changeMaterial(){
  if (default_material == document.getElementById('select_material').value){
    document.getElementById('selected_material').value = 'None';
  }else{
    document.getElementById('selected_material').value = document.getElementById('select_material').value;
  }
}

function changeFinish(){
  if (default_finish == document.getElementById('select_finish').value){
    document.getElementById('selected_finish').value = 'None';
  }else{
    document.getElementById('selected_finish').value = document.getElementById('select_finish').value;
  }
}

function reindex_array(array) {
  var result = [];
  for (var key in array) {
    result.push(array[key]);
  }
  return result;
}

function addAppliance(id){
  // alert(document.getElementById(id));
  item = id.getAttribute("appliance_name");
  // alert(item)
  // appliance_array.push(item);
  // alert(appliance_array.toString());
  // alert($.inArray(item, appliance_array))

  if ($.inArray(item, appliance_array) != -1){
    temp_array = [];
    length = appliance_array.length;
    for (var i =0; i<length; i++){
      if (item != appliance_array[i]){
        temp_array.push(appliance_array[i]);
      }
      appliance_array = temp_array;
    }
    appliance_array = reindex_array(appliance_array);
    alert(appliance_array.toString());
  }else {
    alert('else')
    appliance_array.push(item);
    alert(appliance_array.toString());
  }
  document.getElementById('selected_appliance').value = appliance_array.toString();
}



$( "#select_material" ).change(function() {
  changeMaterial();
});

$( "#select_finish" ).change(function() {
  changeFinish();
});

$('#send_data_form').submit(function() {
  // to disable the submit button to prevent multiple submission
  $(this).find(':input[type=submit]').prop('disabled', true);
});
</script>
{% endblock %}
